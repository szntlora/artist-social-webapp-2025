<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MuseXion - Profile</title>
  <link href="https://fonts.googleapis.com/css2?family=Lora&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Lora:wght@400;600&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  {% load static %}
  <link rel="stylesheet" href="{% static 'css/settings.css' %}">
  <link rel="stylesheet" href="{% static 'css/profile.css' %}">
  <link rel="stylesheet" href="{% static 'css/home_page.css' %}">
  <link rel="stylesheet" href="{% static 'css/theme.css' %}">
  <link rel="icon" type="image/png" href="{% static 'images/pillango1.png' %}">
</head>

<body>
<!-- üîπ NAVBAR -->
<div class="navbar">
  <div class="nav-left">
    <button class="icon-btn" id="settingsBtn" title="Settings">
      <img src="{% static 'images/settings.png' %}" alt="Settings" width="25" height="25">
    </button>
  </div>

  <div class="logo" id="logoBtn">MuseXion</div>

  <div class="nav-right">
    <button class="icon-btn" id="notificationsBtn" title="Notifications">
      <img id="notificationIcon" src="{% static 'images/notification.png' %}" alt="Notifications" width="25" height="25">
    </button>

    <div id="notificationDropdown" class="notification-dropdown hidden">
      <div class="dropdown-header">Notifications</div>
      <div id="notificationList" class="notification-list">
        <p class="loading-notifications">Loading...</p>
      </div>
    </div>

    <button class="icon-btn" id="homeBtn">
      <span>Home</span>
      <img id="logo" src="{% static 'images/pillango1.png' %}" alt="Profile picture" width="28" height="28">
    </button>

    <button class="icon-btn" id="logoutBtn">Log out</button>
  </div>
</div>

<!-- ‚úÖ SETTINGS DRAWER ‚Äì K√úL√ñN a navbar ut√°n -->
<div id="settingsDrawer" class="settings-drawer hidden">
  <div class="settings-panel">
    <div class="settings-menu">
      <h3>‚öôÔ∏è Settings</h3>
      <ul>
        <li data-section="account" class="active">Account Settings</li>
        <li data-section="export">Download My Data</li>
        <li data-section="theme">Theme Mode</li>
        <li data-section="color">Accent Color</li>
      </ul>
    </div>

    <div class="settings-content">
      <div class="settings-header">
        <button id="closeSettingsBtn" class="close-btn">‚úñ</button>
      </div>

      <div class="settings-section" id="section-account">
        <h4>Account</h4>
        <input type="email" id="newEmailInput" placeholder="New email" />
        <button id="updateEmailBtn">Update Email</button>

        <input type="password" id="oldPasswordInput" placeholder="Old password" />
        <input type="password" id="newPasswordInput" placeholder="New password" />
        <button id="updatePasswordBtn">Update Password</button>

        <button id="deleteAccountBtn" class="danger-btn">Delete Account</button>
      </div>

      <div class="settings-section hidden" id="section-export">
        <h4>Export</h4>
        <button id="exportDataBtn">Download My Data</button>
      </div>

      <div class="settings-section hidden" id="section-theme">
        <h4>Theme Mode</h4>
        <button id="toggleThemeBtn">Toggle Light/Dark</button>
      </div>

      <div class="settings-section hidden" id="section-color">
        <h4>Accent Color</h4>
        <div id="colorThemes">
          <span data-color="orange" class="color-circle selected"></span>
          <span data-color="pink" class="color-circle"></span>
          <span data-color="blue" class="color-circle"></span>
          <span data-color="green" class="color-circle"></span>
        </div>
      </div>

      <div id="settingsMessage" class="settings-msg"></div>
    </div>
  </div>
</div>
  <!-- üîπ PROFIL LAYOUT -->
  <div class="profile-layout">

    <!-- BAL PANEL -->
  <aside class="profile-panel">

  <!-- Customize (csak saj√°t profil) -->
  <button id="customizeBtn" class="customize-btn hidden" title="Customize profile">
    <img src="{% static 'images/change.png' %}" alt="Customize" width="20" height="20">
  </button>

  <!-- Profilk√©p -->
  <img id="userProfilePic" 
       src="{% static 'images/default_pfp.png' %}" 
       alt="Profile" 
       class="profile-avatar">

  <!-- Teljes n√©v -->
  <h2 id="userFullName" class="profile-fullname">
     {{ profile_user.first_name }} {{ profile_user.last_name }}
  </h2>

  <!-- Felhaszn√°l√≥n√©v -->
  <p id="userUsername" class="profile-username">@{{ profile_user.username }}</p>

  <!-- Artist type -->
  <p class="profile-artist-type">artist</p>

  <!-- Statisztik√°k -->
  <div class="profile-stats">
    <div class="stat-item">
      <span id="postCount" class="stat-value">0</span>
      <span class="stat-label">Posts</span>
    </div>
    <div class="stat-item">
      <span id="followerCount" class="stat-value">0</span>
      <span class="stat-label">Followers</span>
    </div>
    <div class="stat-item">
      <span id="followingCount" class="stat-value">0</span>
      <span class="stat-label">Following</span>
    </div>
  </div>

  <!-- R√∂vid bio -->
  <div class="profile-bio">
    <p id="userBio">‚ÄúCreating stories through contrast and emotion.‚Äù</p>
  </div>

  <!-- Follow gomb -->
  <button id="followBtn" class="follow-btn">Follow</button>
  
</aside>

  <!-- Follower popup panel -->
  <div id="followPanel" class="follow-popup hidden">
    <div class="follow-popup-content">
      <button class="close-popup" title="Close">&times;</button>
      <h3 id="followPanelTitle">Followers</h3>
      <div id="followList">Loading...</div>
    </div>
  </div>

    <main class="profile-content">

      <!-- üî∏ Saj√°t posztol√°s gomb √©s drawer (csak saj√°t profiln√°l akt√≠v) -->
      <div id="ownProfileSection" class="hidden">
        <!-- üü† Click to Post trigger -->
        <div class="slide-trigger" id="slideTrigger">
          <span>Click</span><span>to</span><span>Post</span>
        </div>
      </div>

      <!-- üî∏ Profil poszt feed ‚Äì mindenkin√©l el√©rhet≈ë -->
      <div id="profileFeed" class="profile-posts-grid">
        <!-- A posztk√°rty√°k itt gener√°l√≥dnak a JS √°ltal -->
      </div>

    </main>
  </div>


     <!-- Slide-out Post Panel -->
    <div id="createPostPanel" class="create-post-drawer">
      <div class="create-post">
        <div class="drawer-header">
          <h3>Create a post...</h3>
          <button id="closeDrawerBtn" class="close-drawer-btn" title="Close drawer">‚úñ</button>
        </div>

        <select id="postCategory" required>
          <option value="">-- Choose Category --</option>
        </select>

        <textarea id="postText" placeholder="Write something..."></textarea>
        <div class="preview-files" id="previewFiles"></div> 

        <div class="post-actions">
          <div class="upload-group">
            <label class="upload-btn" title="Upload images">
              <img src="{% static 'images/picture.png' %}" alt="Upload image">
              <input id="postImage" type="file" accept="image/*" multiple>
            </label>
            <label class="upload-btn" title="Upload video">
              <img src="{% static 'images/video.png' %}" alt="Upload video">
              <input id="postVideo" type="file" accept="video/*">
            </label>
          </div>
          <button class="post-btn" id="postBtn">Post</button>
        </div>

        <div id="postError" class="post-error" aria-live="polite"></div>
      </div>

      <div class="butterfly-container">
        <img src="{% static 'images/pillango1.png' %}" alt="Butterfly" width="60">
      </div>
    </div>


      <!-- üó®Ô∏è COMMENT MODAL -->
    <div id="commentModal" class="modal hidden">
      <div class="modal-content">
        <span class="close-btn">&times;</span>
        <div class="modal-body">
          <div class="left-artwork-info" id="commentArtworkInfo"></div>
          <div class="right-comments-section">
            <div id="commentsList">Loading comments...</div>
            <div class="comment-input">
              <textarea id="newCommentText" placeholder="Write a comment... (@tag someone)"></textarea>
              <button id="submitComment">Post</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Confirm Modal -->
  <div id="confirmModal" class="modal hidden">
    <div class="modal-content">
      <div id="confirmMessage" class="modal-message"></div>
      <div class="modal-buttons">
        <button id="confirmYes" class="btn-confirm yes">Yes</button>
        <button id="confirmNo" class="btn-confirm no">No</button>
      </div>
    </div>
  </div>

  <!-- Toast Container -->
  <div id="toastContainer" class="toast-container"></div>

<!-- üñºÔ∏è IMAGE MODAL -->
<div id="imageModal" class="hidden">
  <div class="modal-controls">
    <a id="downloadImageBtn" download target="_blank" title="Download">
      <img src="{% static 'images/download.png' %}" class="download-icon" alt="Download">
    </a>
    <button id="closeModalBtn" title="Close">
      <img src="{% static 'images/close.png' %}" class="close-modal-icon" alt="Close">
    </button>
  </div>

  <button id="prevImage" class="modal-nav">&#10094;</button>
  <div id="modalContent">
    <img id="modalImage" src="" alt="Artwork Image">
  </div>
  <button id="nextImage" class="modal-nav">&#10095;</button>
</div>

<!-- üéõ Customize Profile Modal -->
<div id="customizeModal" class="modal hidden">
  <div class="modal-content" style="max-width:520px">
    <span class="close-btn" id="closeCustomize">&times;</span>
    <h3>Customize your profile</h3>

    <div class="form-row" style="text-align:center; margin-bottom:20px;">
      <label style="display:block; color:#ccc; font-size:0.9rem;">Profile picture</label>
      <div id="profilePreviewContainer" style="margin-bottom:10px;">
        <img id="profilePreview" src="{% static 'images/default_pfp.png' %}" alt="Preview" width="90" height="90"
            style="border-radius:50%; border:2px solid #ff7b29; object-fit:cover;">
      </div>
      <input id="czProfileImage" type="file" accept="image/*" style="display:none;">
      <button id="uploadTrigger" class="upload-profile-btn">Change Picture</button>
    </div>


    <p id="czUsernameInfo" class="username-info">
      <strong>Username</strong> cannot be changed.
    </p>

    <div class="form-row two-cols">
      <div>
        <label>First name</label>
        <input id="czFirstName" type="text" maxlength="60">
      </div>
      <div>
        <label>Last name</label>
        <input id="czLastName" type="text" maxlength="60">
      </div>
    </div>

    <p id="czNameHint" class="hint">
      You can change your full name once every 30 days.
    </p>

    <div class="form-row">
      <label>Artist type</label>
      <input id="czArtistType" type="text" placeholder="ARTIST / PHOTOGRAPHER / ...">
    </div>

    <div class="form-row">
      <label>Bio</label>
      <textarea id="czBio" rows="4" placeholder="Say something about you..."></textarea>
    </div>

    <div class="modal-buttons">
      <button id="czSave" class="btn-confirm yes">Save changes</button>
      <button id="czCancel" class="btn-confirm no">Cancel</button>
    </div>

    <div id="czError"></div>
  </div>
</div>

<!-- Delete Account Modal (with password input) -->
<div id="deleteAccountModal" class="modal hidden">
  <div class="modal-box dark-box">
    <p class="modal-message">üóëÔ∏è Are you sure you want to permanently delete your MuseXion account?</p>
    
    <input type="password" id="confirm-delete-password" placeholder="Enter your password to confirm" class="input-confirm-password">

    <p id="delete-error" class="error-message" style="display: none;"></p>
    
    <div class="modal-actions">
      <button id="confirmDeleteAccount" class="modal-btn red">Yes, delete</button>
      <button id="cancelDelete" class="modal-btn">Cancel</button>
    </div>
  </div>
</div>



</body>
</html>

<script type="module" src="{% static 'js/auth.js' %}"></script>
<script type="module" src="{% static 'js/utils.js' %}"></script>
<script type="module" src="{% static 'js/notifications.js' %}"></script>
<script type="module" src="{% static 'js/posts.js' %}"></script>
<script type="module" src="{% static 'js/comments.js' %}"></script>
<script type="module" src="{% static 'js/upload.js' %}"></script>
<script type="module" src="{% static 'js/tags.js' %}"></script>
<script type="module" src="{% static 'js/main_profile.js' %}"></script>
<script type="module" src="{% static 'js/settings.js' %}"></script>
<script type="module" src="{% static 'js/themeToggle.js' %}"></script>
<script type="module" src="{% static 'js/login.js' %}"></script>


